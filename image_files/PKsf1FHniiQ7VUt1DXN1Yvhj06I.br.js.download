var GenSerpNewHover;(function(n){function k(){function o(n,i,r,u){n.setAttribute("data-hover-id",i.toString());const e=Object.assign({hoverId:i,target:n,sups:r,triggering:!1,onGetHoverPos:t=>{if(w(t))return{x:t.clientX,y:t.clientY};if(b(t)){const t=n.getBoundingClientRect();return{x:t.left,y:t.bottom}}return{x:0,y:0}},onHighlight:()=>{n.classList.add("b_hover")},onUnHighlight:()=>{n===null||n===void 0?void 0:n.classList.remove("b_hover")}},u);t.push(e);sj_be(n,"mouseenter",n=>{c(n,i)});sj_be(n,"mouseleave",n=>{f(n,i)});rt(n,i)}function a(n,i,r){t.push({hoverId:i,target:n,sups:r,triggering:!1,onGetHoverPos:t=>{if(w(t))return{x:t.clientX,y:t.clientY};if(b(t)){const t=n.getBoundingClientRect();return{x:t.left,y:t.bottom}}return{x:0,y:0}},onHighlight:()=>{},onUnHighlight:()=>{}});sj_be(n,"mousemove",t=>{var r;let u=!1,e=[].slice.call((r=n.querySelector(".gs_cit_txt"))===null||r===void 0?void 0:r.getClientRects());for(let n of e){const i=2;let r=n.bottom-n.height*1.35;if(t.y>=r&&t.y<=n.bottom&&t.x>=n.left-i&&t.x<=n.right+i){u=!0;break}}u?c(t,i):f(t,i)});sj_be(n,"mouseleave",n=>{f(n,i)})}if(i){const e=_qs("#b_genserp_container");r=(e===null||e===void 0?void 0:e.dataset.k)||"";u=(e===null||e===void 0?void 0:e.dataset.appns)||"";h=_qs(".b_genserp_container");let n=1;_d.querySelectorAll(".gs_cit_txt, .gs_cit_stry_preview, .cit_exp_cont, .gs_sup_cit").forEach(t=>{var i,r,u,f,e,s,h,c;if((!_w._enableSearchDetailsPanel||!t.classList.contains("cit_exp_cont"))&&!t.getAttribute("data-hover-id")){if(t.classList.contains("gs_cit_txt")){const r=(i=t.getAttribute("data-sups"))===null||i===void 0?void 0:i.split(",");if(!r)return;o(t,n,r,{});const u=t.closest(".gs_p");u&&a(u,n,r,{})}else if(t.classList.contains("gs_cit_stry_preview")){const i=(u=(r=_qs(".gs_sm_cit .gs_sm_cit_dom",t))===null||r===void 0?void 0:r.getAttribute("data-sups"))===null||u===void 0?void 0:u.split(",");if(!i)return;o(t,n,i)}else if(t.classList.contains("cit_exp_cont")){const i=(e=(f=_qs(".gs_sm_cit .gs_cit_txt",t))===null||f===void 0?void 0:f.getAttribute("data-sups"))===null||e===void 0?void 0:e.split(",");if(!i)return;o(t,n,i)}else if(t.classList.contains("gs_sup_cit")){if(t.closest(".gs_cit_stry_preview")||t.closest(".cit_exp_cont")||t.closest(".gs_cit_repl.b_hide"))return;let u=n,e=null;const i=t.previousElementSibling;let r=(i===null||i===void 0?void 0:i.classList.contains("gs_mdlink"))&&((s=i===null||i===void 0?void 0:i.querySelector(".gs_cit_txt"))===null||s===void 0?void 0:s.getAttribute("data-hover-id"));r||(r=(i===null||i===void 0?void 0:i.classList.contains("gs_cit_txt"))&&(i===null||i===void 0?void 0:i.getAttribute("data-hover-id")));r&&(e=t.closest(".gs_p"),u=parseInt(r),n--);const f=(c=(h=t.querySelector(".gs_sm_cit_dom"))===null||h===void 0?void 0:h.getAttribute("data-sups"))===null||c===void 0?void 0:c.split(",");if(!f)return;let l=()=>{var n;_d.getSelection()&&_d.getSelection().toString()||((n=t.querySelector(".gs_sm_cit"))===null||n===void 0?void 0:n.classList.add("b_hover"))},a=()=>{var n;(n=t.querySelector(".gs_sm_cit"))===null||n===void 0?void 0:n.classList.remove("b_hover")};o(t,u,f,{onHighlight:l,onUnHighlight:a})}n++}});o(i,-1,[],{});sj_be(i,"mouseenter",()=>{i.classList.remove("h_def")});sj_be(i,"mouseleave",()=>{i.classList.add("h_def")});const l=i.querySelectorAll(".hov-item");for(let n of l)sj_be(n,"click",function(n){n.stopPropagation();Log.Log("Click",s,"HoverCitationItemClick",!1,"AppNS",u,"K",r)})}}function c(n){if(!_d.getSelection()||!_d.getSelection().toString()){const r=n.currentTarget,i=t.find(n=>n.target===r);i&&(i.triggering=!0,v(i,n))}}function f(n){const r=n.currentTarget,i=t.find(n=>n.target===r);i&&(i.triggering=!1,v(i,n))}function v(n,i){l&&clearTimeout(l);l=setTimeout(()=>{let n=t.find(n=>n.triggering===!0);if(n===undefined)t.forEach(n=>{n.onUnHighlight()}),d(),e=-1;else{if(n.hoverId===-1)return;t.forEach(t=>{t.hoverId===n.hoverId?t.onHighlight():t.onUnHighlight()});e!==n.hoverId?(y(n,i),e=n.hoverId):y(n,i)}},200)}function y(n,t){var f,o,s,c;const i=h.querySelector(".b_genserp_citation_hover_md");if(i){if(e===n.hoverId){const i=_qs(".b_genserp_citation_hover_md .hov");p(i,n,t);return}if(it(),i.classList.contains("b_hide"))i.classList.remove("b_hide");else{let n=i.querySelector(".hov-anime");n&&(n.style.animation="none",n.offsetHeight,n.style.animation="")}let r=i.querySelectorAll(".hov-item");for(let n=0;n<r.length;n++)r[n].classList.add("b_hide"),((f=r[n].parentElement)===null||f===void 0?void 0:f.className.includes("acf-carousel-pbp__item"))&&((o=r[n].parentElement)===null||o===void 0?void 0:o.setAttribute("hidden",""));for(let t=0;t<n.sups.length;t++){let r=i.querySelector(".hov-item[cit-num='"+n.sups[t]+"']");r&&(r.classList.remove("b_hide"),r.style.order=""+t,((s=r.parentElement)===null||s===void 0?void 0:s.className.includes("acf-carousel-pbp__item"))&&((c=r.parentElement)===null||c===void 0?void 0:c.removeAttribute("hidden")))}const u=_qs(".b_genserp_citation_hover_md .hov");u&&(g(u),p(u,n,t),u.classList.remove("b_hide"));nt(i);tt(i)}}function d(){const n=h.querySelector(".b_genserp_citation_hover_md");n===null||n===void 0?void 0:n.classList.add("b_hide")}function g(n){let t=n.querySelectorAll(".hov-item:not(.b_hide)");if(t&&!(t.length<1)){let r=999,i=t[0];for(let n=0;n<t.length;n++){t[n].classList.contains("first-item")&&t[n].classList.remove("first-item");let u=parseInt(t[n].style.order);u<r&&(r=u,i=t[n])}if(i.classList.contains("first-item")||i.classList.add("first-item"),!_w._enableSearchDetailsPanel){const i=Array.from(t).sort((n,t)=>{let i=parseInt(n.style.order)||0,r=parseInt(t.style.order)||0;return i-r});for(let t=i.length-1;t>=0;t--){const r=i[t];n.insertBefore(r,n.firstChild)}}}}function p(n,t,i){if(n){const{x:e,y:o}=t.onGetHoverPos(i);let r=n.getBoundingClientRect();n.style.top=`${(o+24).toFixed(0)}px`;n.style.left=`${Math.max(e+(r.left-r.right)/2,20).toFixed(0)}px`;const u=window.innerWidth-20,f=window.innerHeight-20;r=n.getBoundingClientRect();r.right>u&&(n.style.left=`${r.left-r.right+u}px`);r.bottom>f&&(n.style.top=`${r.top-r.bottom+f}px`)}}function nt(n){const t=n.querySelector("acf-carousel-pbp"),i=t===null||t===void 0?void 0:t.querySelector(".acf-carousel-pbp__scroll-container");t&&i&&(i.style.scrollBehavior="auto",t.navigateToItemAtIndex&&t.navigateToItemAtIndex(0),i.style.scrollBehavior="")}function tt(n){const t=44,i=n.querySelectorAll(".hov-item");for(let n of i){const i=n.querySelector(".hov-item-ttl"),r=n.querySelector(".hov-item-snip");r&&(i===null||i===void 0?void 0:i.offsetHeight)&&i.offsetHeight<t&&(r.style.webkitLineClamp="3")}}function it(){clearTimeout(a);a=setTimeout(function(){a=-1;Log.Log("Hover",s,"Show5sec",!1,"AppNS",u,"K",r)},5e3);Log.Log("Hover",s,"CitationHover",!1,"AppNS",u,"K",r)}function w(n){return n instanceof MouseEvent?!0:"clientX"in n&&"clientY"in n?!0:!1}function b(n){return n instanceof KeyboardEvent?!0:"key"in n&&"code"in n?!0:!1}function rt(n,t){n===null||n===void 0?void 0:n.setAttribute("tabindex","0");const i=n.parentElement;if(!(i===null||i===void 0?void 0:i.closest(".b_genserp_citation_hover_md"))){i&&i.getAttribute("tabindex")==="0"&&n.setAttribute("tabindex","-1");const u=n.closest(".cit_exp_cont");u&&!u.hasAttribute("tabindex")&&u.setAttribute("tabindex","0");const r=n.querySelector("a[href]:not([tabindex])");r&&(r===null||r===void 0?void 0:r.setAttribute("tabindex","-1"));const f=_d.querySelectorAll('.cit_exp_cont a, .cit_exp_cont .gs_sm_cit[tabindex="0"]');f.forEach(n=>{n.setAttribute("tabindex","-1")});sj_be(n,"keydown",function(i){const{key:r}=i;if(r=="Enter"){i.preventDefault();c(i,t);const{nextFocusableEl:r,prevFocusableEl:u}=ft(n);ut(r,u,t)}})}}function ut(n,i,r){o&&(sb_ct(o),o=null);o=sb_st(function(){const u=Array.from(_d===null||_d===void 0?void 0:_d.querySelectorAll(".hov-item:not(.b_hide)")),s=u===null||u===void 0?void 0:u[0],e=[];s&&s.focus();const o=()=>{let n=t.find(n=>n.triggering===!0);if(n){const t=new MouseEvent("mouseleave",{bubbles:!0,cancelable:!0});Object.defineProperty(t,"currentTarget",{value:n.target,writable:!1});f(t,r);u===null||u===void 0?void 0:u.forEach((n,t)=>{n===null||n===void 0?void 0:n.removeEventListener("keydown",e===null||e===void 0?void 0:e[t])})}};u&&u.length>0&&u.forEach((t,r)=>{const f=f=>{const{key:e,shiftKey:s}=f;if(e==="Escape"){f.preventDefault();o();n===null||n===void 0?void 0:n.focus();return}if(s&&e==="Tab"){r===0&&(f.preventDefault(),o(),i===null||i===void 0?void 0:i.focus());return}if(e==="Tab"&&r===u.length-1&&(f.preventDefault(),o(),n===null||n===void 0?void 0:n.focus()),e==="Enter"){window.open(t.getAttribute("href")||"","_blank");return}};e[r]=f;sj_be(t,"keydown",f)})},200)}function ft(n){function c(n){var t,i;return n?((t=getComputedStyle(n))===null||t===void 0?void 0:t.display)==="none"||((i=getComputedStyle(n))===null||i===void 0?void 0:i.visibility)==="hidden"?!0:(n===null||n===void 0?void 0:n.parentElement)?c(n.parentElement):!1:!1}var f,e,o,s;const l={nextFocusableEl:null,prevFocusableEl:null},t=Array.from(_d.querySelectorAll('a[href], button, input, textarea, select, details, [tabindex]:not([tabindex="-1"])'));if(!t||t.length===0)return l;const h=t.indexOf(n);if(h===-1)return l;const i=t.length;let r=(h+1)%i,u=(h-1+i)%i;while(((f=t===null||t===void 0?void 0:t[r])===null||f===void 0?void 0:f.tabIndex)===-1||c(t===null||t===void 0?void 0:t[r]))r=(r+1)%i;while(((e=t===null||t===void 0?void 0:t[u])===null||e===void 0?void 0:e.tabIndex)===-1||c(t===null||t===void 0?void 0:t[u]))u=(u-1+i)%i;return{nextFocusableEl:(o=t===null||t===void 0?void 0:t[r])!==null&&o!==void 0?o:null,prevFocusableEl:(s=t===null||t===void 0?void 0:t[u])!==null&&s!==void 0?s:null}}const s="GenSerp";var r,u,h;const i=_qs(".b_genserp_citation_hover_md .hov");let t=[];n.init=k;let l=null,e=-1;let a=-1;let o=null})(GenSerpNewHover||(GenSerpNewHover={}));_w.GenSerpHover=GenSerpNewHover